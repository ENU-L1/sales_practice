--  CREATE DATABASE AND USE

CREATE DATABASE sales_practice;

USE sales_practice;


-- CREATE TABLE EMPLOYEES, CUSTOMER & SALES

CREATE TABLE `employees` (
  `EMPLOYEE_CODE` char(6) NOT NULL,
  `EMPLOYEE_NAME` char(40) DEFAULT NULL,
  `WORKING_AREA` char(35) DEFAULT NULL,
  `COUNTRY` varchar(25) DEFAULT NULL,
  PRIMARY KEY (`EMPLOYEE_CODE`)
)

CREATE TABLE `customer` (
  `CUST_CODE` varchar(6) NOT NULL,
  `CUST_NAME` varchar(40) NOT NULL,
  `CUST_CITY` char(35) DEFAULT NULL,
  `CUST_COUNTRY` varchar(20) NOT NULL,
  `PAYMENT_AMT` int NOT NULL,
  `ADVANCE_AMT` int NOT NULL,
  `EMPLOYEE_CODE` char(6) NOT NULL,
  PRIMARY KEY (`CUST_CODE`),
  KEY `EMPLOYEE_CODE_idx` (`EMPLOYEE_CODE`),
  CONSTRAINT `EMPLOYEE_CODE` FOREIGN KEY (`EMPLOYEE_CODE`) REFERENCES `employees` (`EMPLOYEE_CODE`)
) 

CREATE TABLE `sales` (
  `SALE_NUM` int NOT NULL,
  `SALE_AMOUNT` int NOT NULL,
  `ADVANCE_AMOUNT` int NOT NULL,
  `SALE_DATE` date NOT NULL,
  `CUST_CODE` varchar(6) NOT NULL,
  `EMPLOYEE_CODE` char(6) NOT NULL,
  PRIMARY KEY (`SALE_NUM`),
  KEY `CUST_CODE_idx` (`CUST_CODE`),
  KEY `EMPLOYEE_CODE_idx` (`EMPLOYEE_CODE`),
  CONSTRAINT `CUST_CODE` FOREIGN KEY (`CUST_CODE`) REFERENCES `customer` (`CUST_CODE`)
) 

--  PUT VALUES IN

INSERT INTO EMPLOYEES VALUES ('E018', 'Neasa', 'Wellingtong', 'New Zealand');
INSERT INTO EMPLOYEES VALUES ('E019', 'Silvius', 'Athens', 'Greece');
INSERT INTO EMPLOYEES VALUES ('E015', 'Psyche', 'Arequipa', 'Peru');
INSERT INTO EMPLOYEES VALUES ('E017', 'Salamon', 'Aalborg', 'Denmark');
INSERT INTO EMPLOYEES VALUES ('E013', 'Clementia ', 'Arequipa', 'Peru');
INSERT INTO EMPLOYEES VALUES ('E021', 'Epimetheus', 'Aalborg', 'Denmark');
INSERT INTO EMPLOYEES VALUES ('E022', 'Heru', 'Aalborg', 'Denmark');
INSERT INTO EMPLOYEES VALUES ('E010', 'Hut-Heru', 'Aalborg', 'Denmark');
INSERT INTO EMPLOYEES VALUES ('E026', 'Jocasta', 'Arequipa', 'Peru');
INSERT INTO EMPLOYEES VALUES ('E011', 'Klotho', 'Athens', 'Greece');
INSERT INTO EMPLOYEES VALUES ('E012', 'Arete', 'Wellingtong', 'New Zealand');

INSERT INTO CUSTOMER VALUES ('C00125', 'Vesper ', 'Thessaloniki', 'Greece', '400.00', '80.00', 'E010');
INSERT INTO CUSTOMER VALUES ('C00124', 'Thanatos ', 'Lima', 'Peru', '700.00', '60.00', 'E022');
INSERT INTO CUSTOMER VALUES ('C00115', 'Rayne ', 'Vejle', 'Denmark', '300.00', '110.00', 'E018');
INSERT INTO CUSTOMER VALUES ('C00221', 'Reign ', 'Vejle', 'Denmark', '700.00', '70.00', 'E013');
INSERT INTO CUSTOMER VALUES ('C00319', 'Velvet ', 'Thessaloniki', 'Greece', '700.00', '80.00', 'E021');
INSERT INTO CUSTOMER VALUES ('C00223', 'Horus', 'Vejle', 'Denmark', '700.00', '30.00', 'E024');
INSERT INTO CUSTOMER VALUES ('C00205', 'Anubis', 'Lima', 'Peru', '700.00', '110.00', 'E018');
INSERT INTO CUSTOMER VALUES ('C00202', 'Blaze ', 'Wellingtong', 'New Zealand', '900.00', '30.00', 'E010');
INSERT INTO CUSTOMER VALUES ('C00208', 'Nephthys', 'Wellingtong', 'New Zealand', '900.00', '50.00', 'E019');
INSERT INTO CUSTOMER VALUES ('C00103', 'Hapi', 'Thessaloniki', 'Greece', '700.00', '80.00', 'E026');
INSERT INTO CUSTOMER VALUES ('C00218', 'Ophelia ', 'Thessaloniki', 'Greece', '900.00', '50.00', 'E024');
INSERT INTO CUSTOMER VALUES ('C00113', 'Damien ', 'Lima', 'Peru', '700.00', '40.00', 'E021');
INSERT INTO CUSTOMER VALUES ('C00101', 'Dagon ', 'Wellingtong', 'New Zealand', '200.00', '60.00', 'E024');
INSERT INTO CUSTOMER VALUES ('C00107', 'Koios', 'Thessaloniki', 'Greece', '900.00', '90.00', 'E017');
INSERT INTO CUSTOMER VALUES ('C00122', 'Avinash', 'Lima', 'Peru', '900.00', '90.00','E026');
INSERT INTO CUSTOMER VALUES ('C00309', 'Atem', 'Wellingtong', 'New Zealand', '30.00', '12.00', 'E017');
INSERT INTO CUSTOMER VALUES ('C00114', 'Eros', 'Thessaloniki', 'Greece', '700.00', '120.00', 'E015');
INSERT INTO CUSTOMER VALUES ('C00104', 'Eldritch ', 'Wellingtong', 'New Zealand', '70.00', '6.00', 'E021');
INSERT INTO CUSTOMER VALUES ('C00206', 'Phyllis', 'Vejle', 'Denmark', '60.00', '11.00', 'E026');
INSERT INTO CUSTOMER VALUES ('C00210', 'Hapi', 'Thessaloniki', 'Greece', '50.00', '5.00', 'E015');
INSERT INTO CUSTOMER VALUES ('C00317', 'Ammon', 'Lima', 'Peru', '30.00', '9.00', 'E015');
INSERT INTO CUSTOMER VALUES ('C00112', 'Hapi', 'Vejle', 'Denmark', '90.00', '30.00', 'E010');
INSERT INTO CUSTOMER VALUES ('C00116', 'Serket', 'Vejle', 'Denmark', '70.00', '12.00', 'E019');
INSERT INTO CUSTOMER VALUES ('C00211', 'Asar', 'Lima', 'Peru', '70.00', '11.00', 'E019');

INSERT INTO SALES VALUES('201100', '100.00', '60.00', '2018-08-01', 'C00120', 'E018');
iNSERT INTO SALES VALUES('202130', '250.00', '40.00', '2018-07-30', 'C00114', 'E019');
INSERT INTO SALES VALUES('204105', '250.00', '50.00', '2018-07-18', 'C00114', 'E010');
INSERT INTO SALES VALUES('205109', '350.00', '80.00', '2018-07-30', 'C00202', 'E022');
INSERT INTO SALES VALUES('200112', '200.00', '40.00', '2018-05-30', 'C00125', 'E013');
INSERT INTO SALES VALUES('200102', '200.00', '30.00', '2018-05-25', 'C00221', 'E026');
INSERT INTO SALES VALUES('200120', '500.00', '100.00', '2018-07-20', 'C00221', 'E021');
INSERT INTO SALES VALUES('203107', '450.00', '90.00', '2018-08-30', 'C00115', 'E015');
INSERT INTO SALES VALUES('201119', '400.00', '70.00', '2018-09-16', 'C00101', 'E015');
INSERT INTO SALES VALUES('202114', '350.00', '200.00', '2018-08-15', 'C00221', 'E017');
INSERT INTO SALES VALUES('202101', '300.00', '100.00', '2018-07-15', 'C00208', 'E024');
INSERT INTO SALES VALUES('200130', '300.00', '50.00', '2018-04-15', 'C00221', 'E026');
INSERT INTO SALES VALUES('202127', '250.00', '40.00', '2018-07-20', 'C00221', 'E011');
INSERT INTO SALES VALUES('201134', '420.00', '180.00', '2018-09-25', 'C00115', 'E021');
INSERT INTO SALES VALUES('201108', '400.00', '60.00', '2018-02-15', 'C00125', 'E015');
INSERT INTO SALES VALUES('201103', '150.00', '70.00', '2018-05-15', 'C00125', 'E022');
INSERT INTO SALES VALUES('201128', '350.00', '150.00', '2018-07-20', 'C00101', 'E024');
INSERT INTO SALES VALUES('202113', '400.00', '60.00', '2018-06-10', 'C00120', 'E021');
INSERT INTO SALES VALUES('202135', '200.00', '80.00', '2018-09-16', 'C00120', 'E012');
INSERT INTO SALES VALUES('202131', '900.00', '150.00', '2018-08-26', 'C00309', 'E012');
INSERT INTO SALES VALUES('202106', '250.00', '70.00', '2018-04-20', 'C00221', 'E019');
INSERT INTO SALES VALUES('202125', '200.00', '60.00', '2018-10-10', 'C00309', 'E024');
INSERT INTO SALES VALUES('201117', '80.00', '20.00', '2018-10-20', 'C00309', 'E013');
INSERT INTO SALES VALUES('201126', '550.00', '150.00', '2018-06-24', 'C00210', 'E011');
INSERT INTO SALES VALUES('201129', '250.00', '00.00', '2018-07-20', 'C00210', 'E013');
INSERT INTO SALES VALUES('201123', '500.00', '100.00', '2018-09-16', 'C00101', 'E010');
INSERT INTO SALES VALUES('201111', '100.00', '30.00', '2018-07-10', 'C00208', 'E019');
INSERT INTO SALES VALUES('201104', '150.00', '50.00', '2018-03-13', 'C00208', 'E018');
INSERT INTO SALES VALUES('203121', '150.00', '60.00', '2018-09-23', 'C00101', 'E024');
INSERT INTO SALES VALUES('202122', '250.00', '40.00', '2018-09-16', 'C00101', 'E017');
INSERT INTO SALES VALUES('202116', '500.00', '100.00', '2018-07-13', 'C00221', 'E010');
INSERT INTO SALES VALUES('100133', '120.00', '40.00', '2018-06-29', 'C00114', 'E019');


--  UPDATE CUST_CITY TO CITY

ALTER TABLE `sales_practice`.`customer` 
CHANGE COLUMN `CUST_CITY` `City` CHAR(35) NULL DEFAULT NULL ;


--  ADD NEW INFO TO CUSTOMER TABLE

INSERT INTO CUSTOMER VALUES ('C00026', 'Felix', 'Athens', 'Greece', '700.00', '150.00', 'E021');


--  FIX CUSTOMER/EMPLOYEES TABLE FROM Wellingtong TO Wellington

UPDATE customer
SET city = 'Wellington'
WHERE city = 'Wellingtong';

UPDATE employees
SET WORKING_AREA = 'Wellington'
WHERE WORKING_AREA = 'Wellingtong';


--  CITIES THAT START WITH V OR END WITH I

SELECT * FROM `sales_practice`.customer
WHERE City like "v%" || City like "%i"
order by CUST_NAME;


--  SALE NUMBERS, AMOUNTS & DATES

FROM `sales_practice`.sales
WHERE SALE_DATE BETWEEN '2018-06-01' AND '2018-07-31'
ORDER BY SALE_AMOUNT;


--  MAX ADVANCE AMOUNT PER CITY

SELECT City, MAX(ADVANCE_AMT)
FROM `sales_practice`.customer
GROUP BY City;


--  AVERAGE PAYMENT AMOUNT BY COUNTRY

SELECT CUST_COUNTRY, AVG(PAYMENT_AMT)
FROM `sales_practice`.customer
GROUP BY CUST_COUNTRY;


--  LIST CUSTOMER NAME, PAYMENT AMOUNT & EMPLOYEE NAMES

SELECT customer.CUST_NAME, customer.PAYMENT_AMT, employees.EMPLOYEE_NAME
FROM `sales_practice`.customer
INNER JOIN `sales_practice`.employees 
ON customer.EMPLOYEE_CODE = employees.EMPLOYEE_CODE


--  ADD NEW VALUE TO EMPLOYEE TABLE

INSERT INTO EMPLOYEES VALUES ('E009', 'Iris', 'Aalborg', 'Denmark');


--  LIST EMPLOYEE NAMES & SALE NUMBERS 

SELECT employees.EMPLOYEE_NAME, sales.SALE_NUM
FROM `sales_practice`.employees
INNER JOIN `sales_practice`.sales 
ON employees.EMPLOYEE_CODE = sales.EMPLOYEE_CODE;


--  LIST ALL SALE NUMBERS & DATE MADE

SELECT  SALE_NUM, SALE_DATE
FROM `sales_practice`.sales;

